# Прогнозирование Остаточного Ресурса (RUL) Авиадвигателей

Этот проект представляет собой комплексное исследование по прогнозированию остаточного ресурса (RUL) турбовентиляторных двигателей с использованием набора данных NASA C-MAPSS. В проекте реализованы и сравнены два подхода: классическое машинное обучение и продвинутая гибридная нейронная сеть (CNN-LSTM с механизмом Attention).

## Данные

Используется набор данных `FD001` из репозитория C-MAPSS. Данные содержат временные ряды с 21 сенсора для 100 двигателей.

-   **`train_FD001.txt`**: Обучающие данные.
-   **`test_FD001.txt`**: Тестовые данные (двигатели выключаются до отказа).
-   **`RUL_FD001.txt`**: Истинные значения RUL для тестовых данных.

## Особенности Проекта

-   **Два подхода:** Сравнение производительности классических моделей (Random Forest, XGBoost) и Deep Learning (PyTorch).
-   **Глубокий EDA:** Исследовательский анализ данных для понимания трендов и корреляций.
-   **Feature Engineering:** Создание признаков на основе скользящих средних для улучшения качества моделей.
-   **Продвинутая архитектура:** Реализация гибридной сети CNN-LSTM с механизмом Attention для эффективного анализа временных рядов.
-   **Кастомная функция потерь:** Использование асимметричной MSE для более сильного штрафа за опасные прогнозы (переоценка RUL).
-   **Оптимизация гиперпараметров:** Применение `Optuna` для автоматического подбора лучших параметров нейросети.

## Структура Репозитория

-   **`/data`**: Содержит исходные файлы набора данных C-MAPSS.
-   **`/notebooks`**: Jupyter-ноутбуки с пошаговым анализом:
    -   `1_EDA_and_Classical_ML.ipynb`: Исследовательский анализ и базовые модели ML.
    -   `2_Deep_Learning_CNN_LSTM.ipynb`: Реализация, обучение и оценка гибридной нейросети.
-   **`/src`**: Исходный код для модульности и переиспользования.
    -   `models.py`: Определение архитектуры нейросети `RUL_CNN_LSTM_Attention_v6`.
    -   `train.py`: Скрипт для обучения и сохранения нейронной сети.
    -   `utils.py`: Вспомогательные функции (например, для подготовки данных).
-   `requirements.txt`: Список необходимых библиотек.
-   `README.md`: Этот файл.

## Установка и Запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://your-repository-url.git
    cd RUL_Prediction_Project
    ```

2.  **Создайте и активируйте виртуальное окружение:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Windows: venv\Scripts\activate
    ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Изучите ноутбуки:**
    Откройте и запустите ячейки в `notebooks/EDA_and_Classic_ML.ipynb` и `notebooks/CNN_LSTM.ipynb` для пошагового воспроизведения анализа и результатов.

5.  **(Опционально) Запустите обучение модели из командной строки:**
    ```bash
    python src/train.py --epochs 50 --lr 0.0001
    ```

## Результаты

| Модель | Подход | RMSE на тесте | Ключевые особенности |
| :--- | :--- | :--- | :--- |
| Random Forest | Классический ML | ~31 | Хороший baseline, высокая интерпретируемость. |
| **CNN-LSTM+Attention** | **Deep Learning** | **~16.14** | **Высокая точность, учет временных зависимостей, кастомная логика ошибок.** |

**Вывод:** Гибридная нейросетевая модель значительно превосходит классические подходы благодаря своей способности эффективно моделировать сложные временные паттерны в данных с датчиков.
